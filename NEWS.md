# NEWS.md

This file contains information about major updates since 1.0.

## Version 3

Version 3 is a greatly slimmed repository, focusing just on those tools that are relevant for modern Julia development.
Users of tools that were removed should stick with SnoopCompile 2.x.

- The old `@snoopc` has been deleted. Its functionality was largely subsumed into `julia --trace-compile`.
-`@snoopi` has been deleted, as `@snoopi_deep` (now renamed to `@snoop_inference`) provides more comprehensive information and is available on all modern Julia versions.
- SnoopCompileBot was deleted in favor of [CompileBot](https://github.com/aminya/CompileBot.jl)
- SnoopPrecompile was deleted because it is now [PrecompileTools](https://github.com/JuliaLang/PrecompileTools.jl)

Additionally:
- `@snoopr` has been renamed `@snoop_invalidations`.
- `@snoopl` has been renamed `@snoop_llvm`.


## Version 1.1

This version implements major changes in how `parcel` works on the output of `@snoopi`:

- keyword-supplying methods are now looked up as `Core.kwftype(f)` rather than by
  the gensymmed name (`var"#f##kw"` or `getfield(Base, Symbol("#kw##sum"))`)
- On Julia 1.4+, SnoopCompile will write precompile directives for keyword-body functions
  (sometimes called the "implementation" function) that look them up by an algorithm that
  doesn't depend on the gensymmed name. For example,
  ```julia
  let fbody = try __lookup_kwbody__(which(printstyled, (String,Vararg{String,N} where N,))) catch missing end
    if !ismissing(fbody)
        precompile(fbody, (Bool,Symbol,typeof(printstyled),String,Vararg{String,N} where N,))
    end
  end
  ```
  For files that have precompile statements for keyword-body functions, the `__lookup_kwbody__`
  method is defined at the top of the file generated by `SnoopCompile.write`.
- Function generators are looked up in a gensym-invariant manner with statements like
  ```julia
  precompile(Tuple{typeof(which(FuncKinds.gen2,(Int64,Any,)).generator.gen),Any,Any,Any})
  ```
- Anonymous functions and inner functions are looked up inside an `isdefined` check, to
  prevent errors when the precompile file is used on a different version of Julia with
  different gensym numbering.

Other changes:
- A convenience utility, `timesum`, was introduced (credit to aminya)

